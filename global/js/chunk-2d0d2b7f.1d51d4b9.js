(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d2b7f"],{"5a63":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",{staticClass:"tab-layout",attrs:{"no-body":""}},[e.showMainHeader&&e.activeTableRef&&e.activeTableRef.table?a("h5",{staticClass:"text-center mb-0 px-3 py-3 over-hover"},[a("span",{domProps:{innerHTML:e._s(e.activeTableRef.table.header)}})]):e._e(),a("b-tabs",{attrs:{justified:"",card:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.tables,(function(t,i){return a("b-tab",{key:t,scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e.titles[i])+" ")]},proxy:!0}],null,!0)},[a("keep-alive",[e.isTabActive(i)?a("platon-table",{ref:"tables",refInFor:!0,attrs:{"table-name":t,"table-filters":e.getFiltersFor(i),"external-filters":e.filtersAndButtons,"show-header":e.showHeader,"use-external-buttons":e.useExternalButtons,"use-external-filters":e.useExternalFilters,"control-buttons":!0,"pagination-enabled":!0,"show-filters":!0,draw:i===e.activeTab},on:{tableLoaded:function(t){return e.onTableLoaded(i,t)},onFiltersChange:function(t){return e.onTableFilterChanged(i,t)}}}):e._e()],1)],1)})),1)],1)},r=[],s=a("9523"),n=a.n(s),l=a("64f5"),o=a("2ce5"),b=a("b441");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){n()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const u=["_page","_level"];var d={name:"MultiTable",mixins:[o["a"]],props:{tables:{type:Array,required:!0},titles:{type:Array,required:!0},showHeader:{type:Boolean,default:!1},showMainHeader:{type:Boolean,default:!1},separateFilters:{type:Boolean,default:!1},mainTable:{type:String,required:!0},useExternalButtons:{type:Boolean,default:!1},useExternalFilters:{type:Boolean,default:!0}},data(){let e=this.tables.findIndex(e=>e===this.mainTable),t=this.tables.findIndex(e=>e===this.$route.query.__tab),a=-1!==t?t:e,i=c({},this.$route.query);return{filters:i,activeTab:a,mainTabIndex:e,filtersAndButtons:[],mainTableRef:null,activeTableRef:null}},mounted(){this.registerLinkHandler(this.tableLinkHandler)},beforeDestroy(){this.unregisterLinkHandler()},methods:{onTableLoaded(e,t){this.updateMainHeader(),this.mainTabIndex===e&&(this.mainTableRef=t,this.filtersAndButtons=t.filtersAndButtons)},getFiltersFor(e){let t=c({},e===this.mainTabIndex?this.mainFilters:this.filters),a=this.tables[e];if(this.separateFilters)for(let i of u)t[`${i}_${a}`]&&(t[i]=t[`${i}_${a}`]);return t},onFiltersChange(e){this.changeFiltersForTab(this.activeTab,e)},onTableFilterChanged(e,t){e===this.activeTab&&this.changeFiltersForTab(e,t)},changeFiltersForTab(e,t){Object(b["DevLog"])("Table filters changed",t);let a=c({},t),i=this.tables[e];if(this.separateFilters)for(let r of u)a[r]&&(a[`${r}_${i}`]=a[r],delete a[r]);this.handleFilterChange(c(c({},a),{},{__tab:i}))},handleFilterChange(e){0!==Object.keys(e).length&&Object(l["o"])(e,this.filters)&&(this.$set(this,"filters",e),this.changeActiveTabIfNeeded(),this.$router.push({query:e}))},changeActiveTabIfNeeded(){let e=this.activeTab,t=this.tables.findIndex(e=>e===this.filters.__tab);e!==t&&(this.activeTab=t)},tableLinkHandler(e){if("table"===e.name&&e.params.name===this.activeTabName)return this.onFiltersChange(e.query),!0},updateMainHeader(){this.$nextTick(()=>{this.activeTableRef=this.$refs.tables.find(e=>e.tableName===this.activeTabName)})},isTabActive(e){return e===this.activeTab||e===this.mainTabIndex}},computed:{mainFilters(){return this.filters.__tab!==this.mainTable?c(c({},this.filters),{},{__tab:this.mainTable}):c({},this.filters)},activeTabName(){return this.tables[this.activeTab]}},watch:{activeTab(e){this.handleFilterChange(c(c({},this.filters),{},{__tab:this.tables[e]})),this.updateMainHeader()},$route(e,t){this.onFiltersChange(c({__tab:this.tables[this.activeTab]},e.query))}}},f=d,p=a("2877"),T=Object(p["a"])(f,i,r,!1,null,null,null);t["default"]=T.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21d50e"],{d17b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",{staticClass:"tab-layout",attrs:{"no-body":""}},[e.showMainHeader&&e.activeTableRef&&e.activeTableRef.table?a("h5",{staticClass:"text-center mb-0 px-3 py-3 over-hover"},[a("span",{domProps:{innerHTML:e._s(e.activeTableRef.table.header)}})]):e._e(),a("b-tabs",e._b({model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},"b-tabs",e.computedTabProps,!1),e._l(e.computedTabs,(function(t,i){return a("b-tab",e._b({key:t.__key,on:{click:function(a){return e.onTabClick(i,t)}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(t.title)+" ")]},proxy:!0}],null,!0)},"b-tab",t.options,!1),[a("keep-alive",["page"===t.type&&e.isTabActive(i)?a("page-renderer",{attrs:{name:e.getTabName(t)}}):"table"===t.type&&e.isTabActive(i)?a("platon-table",{ref:"tables",refInFor:!0,attrs:{"table-name":e.getTabName(t),"table-filters":e.getFiltersFor(i),"external-filters":e.filtersAndButtons,"show-header":e.showHeader,"use-external-buttons":e.useExternalButtons,"use-external-filters":e.useExternalFilters,"control-buttons":!0,"pagination-enabled":!0,"show-filters":!0,draw:i===e.activeTab},on:{tableLoaded:function(t){return e.onTableLoaded(i,t)},onFiltersChange:function(t){return e.onTableFilterChanged(i,t)}}}):e._e()],1)],1)})),1)],1)},s=[],n=a("9523"),r=a.n(n),b=a("64f5"),l=a("2ce5"),o=a("b441"),h=a("dae0"),c=a("6c9a");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){r()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const d=["_page","_level"];var f={name:"MultiTab",components:{PageRenderer:h["a"]},mixins:[l["a"],c["a"]],props:{tabs:{type:Array},tabProps:{},showHeader:{type:Boolean,default:!1},showMainHeader:{type:Boolean,default:!1},separateFilters:{type:Boolean,default:!1},useExternalButtons:{type:Boolean,default:!1},useExternalFilters:{type:Boolean,default:!1}},data(){let e=this.tabs.findIndex(e=>!0===e.main),t=this.tabs.findIndex(e=>this.getTabName(e)===this.$route.query.__tab&&e.type===this.$route.query.__type),a=t>=0?t:e,i=p({},this.$route.query);return{filters:i,activeTab:a,mainTabIndex:e,mainTab:this.tabs[e],filtersAndButtons:[],mainTableRef:null,activeTableRef:null}},mounted(){this.registerLinkHandler(this.tableLinkHandler)},beforeDestroy(){this.unregisterLinkHandler()},methods:{onTableLoaded(e,t){this.updateMainHeader(),this.mainTabIndex===e&&(this.mainTableRef=t,this.filtersAndButtons=t.filtersAndButtons)},getFiltersFor(e){let t=p({},e===this.mainTabIndex?this.mainFilters:this.filters),a=this.getTabName(this.tabs[e]);if(this.separateFilters)for(let i of d)t[`${i}_${a}`]&&(t[i]=t[`${i}_${a}`]);return t},onFiltersChange(e){this.changeFiltersForTab(this.activeTab,e)},onTableFilterChanged(e,t){e===this.activeTab&&this.changeFiltersForTab(e,t)},changeFiltersForTab(e,t){Object(o["DevLog"])("Table filters changed",t);let a=p({},t),i=this.tabs[e];if(this.separateFilters)for(let s of d)a[s]&&(a[`${s}_${this.getTabName(i)}`]=a[s],delete a[s]);this.handleFilterChange(p(p({},a),{},{__tab:this.getTabName(i),__type:i.type}))},handleFilterChange(e){0!==Object.keys(e).length&&Object(b["o"])(e,this.filters)&&(this.$set(this,"filters",e),this.changeActiveTabIfNeeded(),this.$router.push({query:e}))},changeActiveTabIfNeeded(){let e=this.activeTab,t=this.tabs.findIndex(e=>this.getTabName(e)===this.filters.__tab&&e.type===this.filters.__type);e!==t&&(this.activeTab=t)},tableLinkHandler(e){return"page"===e.name&&e.params.name===this.$route.params.name&&this.$route.query.__tab===this.activeTabName||"table"===e.name&&e.params.name===this.activeTabName?(this.onFiltersChange(e.query),!0):void 0},updateMainHeader(){this.$nextTick(()=>{this.activeTableRef=this.$refs.tables.find(e=>e.tableName===this.activeTabName)})},isTabActive(e){return e===this.activeTab||e===this.mainTabIndex},canRenderTab(e){return"function"!==typeof e.canRender||e.canRender.call(this,e)},onTabClick(e,t){"function"===typeof t.onTabClick&&t.onTabClick.call(this,t,e)},getTabName(e){return"function"===typeof e.name?e.name.call(this,e):e.name}},computed:{mainFilters(){return this.filters.__tab!==this.getTabName(this.mainTab)&&this.filters.__type!==this.mainTab.type?p(p({},this.filters),{},{__tab:this.getTabName(this.mainTab),__type:this.mainTab.type}):p(p({},this.filters),{},{__tab:this.getTabName(this.tabs[this.activeTab]),__type:this.tabs[this.activeTab].type})},activeTabName(){return this.getTabName(this.tabs[this.activeTab])},computedTabProps(){return Object.assign({justified:!0,card:!0},p({},this.tabProps))},computedTabs(){return this.tabs.map((e,t)=>p(p({},e),{},{__key:e.type+e.name.toString()+t})).filter(e=>this.canRenderTab(e))}},watch:{activeTab(e){this.handleFilterChange(p(p({},this.filters),{},{__tab:this.getTabName(this.tabs[e]),__type:this.tabs[e].type})),this.updateMainHeader()},$route(e,t){this.onFiltersChange(p({__tab:this.getTabName(this.tabs[this.activeTab]),__type:this.tabs[this.activeTab].type},e.query))}}},T=f,m=a("2877"),y=Object(m["a"])(T,i,s,!1,null,null,null);t["default"]=y.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ef7ef87"],{4278:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-card",{staticClass:"mt-5",attrs:{"no-body":""},scopedSlots:t._u([(t.title,{key:"header",fn:function(){return[o("h4",[o("span",[t._v(t._s(t.title))]),t._v(" "),o("i",{staticClass:"fa fa-expand-alt",on:{click:t.toggleFullScreen}})])]},proxy:!0})],null,!0)},[o("div",{ref:"mapWidget",staticStyle:{width:"100%",height:"700px"},attrs:{id:"mapWidget"}})])},n=[],i=o("b17c"),a=o.n(i),l=o("448a"),s=o.n(l),p=o("94ae"),d=o.n(p),u=(o("6cc5"),o("20d6"),o("5fbf"),o("b441")),h=o("e848"),m=o("ea7f"),g={name:"WidgetInfoMap",props:{options:{required:!0}},data(){return{fullScreen:!1,infoControl:null}},created(){d.a.drawLocal=h["a"]},mounted(){this.renderMap()},methods:{renderMap(){this.setupMap(),this.initInfoContol(),this.renderPolygonFromInput()},getMapCenter(){return a()(d.a.LatLng,s()(this.mapCenter))},getMapZoom(){let t=Number(this.defaultMapZoom);return Number.isInteger(t)?t:13},getColor(t){let e=(this.options.polygons||[]).map(t=>t[this.options.valueField]),o=Math.max.apply(Math,s()(e)),r=Math.min.apply(Math,s()(e));return m["Color"].parse(this.colors[0]).tweenTo(m["Color"].parse(this.colors[1]),t/(o-r))},renderPolygonFromJson(t){let e=new d.a.GeoJSON(t,{onEachFeature:(t,e)=>{e.addTo(this.drawingLayer);(d.a.GeometryUtil.geodesicArea(e.getLatLngs()[0])/1e4).toFixed(2);e.on({mouseover:t=>{var e=t.target;e._map.infoControl.updateInfo(e.feature.properties),e.setStyle({weight:2,fillOpacity:.7}),d.a.Browser.ie||d.a.Browser.opera||d.a.Browser.edge||e.bringToFront()},mouseout:t=>{var e=t.target;e._map.infoControl.updateInfo(),e.setStyle({weight:1,fillOpacity:.5}),d.a.Browser.ie||d.a.Browser.opera||d.a.Browser.edge||e.bringToFront()}})},style:t=>({fillColor:this.getColor(t.properties[this.options.valueField]),weight:1,opacity:1,color:this.getColor(1.1*t.properties[this.options.valueField]),fillOpacity:.5})});e.infoControl=this.infoControl,this.map.fitBounds(this.drawingLayer.getBounds())},initInfoContol(){this.infoControl=d.a.control({position:"bottomright"}),this.infoControl._div=d.a.DomUtil.create("div","areaInfo"),this.infoControl.onAdd=function(t){return this.updateInfo(),this._div},this.infoControl.updateInfo=function(t){let e="";if(t){let o;for(o in e='<div class="dataHolder"><h4>Малумотлар</h4>',t)e+="<h6><b>"+o+"</b>: "+t[o]+"</h6>";e+="<div>"}this._div.innerHTML=e},this.map.infoControl=this.infoControl,this.map.addControl(this.infoControl);var t=d.a.control({position:"bottomleft"});t.onAdd=t=>{let e=d.a.DomUtil.create("div","infoLegend"),o=0;for(o=0;o<[1,3,4].length;o++)e.innerHTML+='<i style="background:'+this.getColor(o)+'"></i> '+o+(o?"&ndash;"+o+"<br>":"+");return e},this.map.addControl(t)},setupMap(){this.map=new d.a.Map("mapWidget",{center:this.getMapCenter(),zoom:this.getMapZoom()}),this.drawingLayer=d.a.featureGroup().addTo(this.map);let t=d.a.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],attribution:"google"}),e=d.a.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],attribution:"google"});d.a.control.layers({googleSat:t.addTo(this.map),googleStreets:e},{[this.$l("platon.mappolygon.drawinglayer","Чизмалар")]:this.drawingLayer},{position:"bottomright",collapsed:!1}).addTo(this.map)},renderPolygonFromInput(){let t=this.options.polygons||[],e=t.map(t=>{let e,o={};for(e in t)"geo_polygon"!==e&&(o[e]=t[e]);return{type:"Feature",properties:o,geometry:JSON.parse(t.geo_polygon.value)}}),o={type:"FeatureCollection",features:e};this.drawingLayer.clearLayers(),this.renderPolygonFromJson(o)},toggleFullScreen(){!document.fullscreenElement&&this.fullScreen&&(this.fullScreen=!1),this.fullScreen?document.exitFullscreen():this.$refs.mapWidget.requestFullscreen(),this.fullScreen=!this.fullScreen}},computed:{title(){return this.options.title||""},mapCenter(){return this.options.mapCenter||u["DEFAULT_MAP_CENTER"]},defaultMapZoom(){return this.options.mapZoom||11},colors(){return this.options.colors||["#fff","#00f"]}}},c=g,f=(o("540b"),o("2877")),y=Object(f["a"])(c,r,n,!1,null,null,null);e["default"]=y.exports},"540b":function(t,e,o){"use strict";o("753c")},"753c":function(t,e,o){}}]);